import{r as s,C as b,j as e,F as h}from"./index-B0UwScz_.js";const u=b.api.scriptURL,w=s.memo(({item:r,user:t,token:n,onDetails:c,showNotify:i})=>{const[x,l]=s.useState(!1),a=s.useMemo(()=>r.downloadDisponivel||t.isVIP,[r.downloadDisponivel,t.isVIP]),m=s.useMemo(()=>{if(!r.dataCompra)return"Data desconhecida";try{const o=new Date(r.dataCompra);return o.toLocaleDateString("pt-BR")+" às "+o.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}catch{return"Data inválida"}},[r.dataCompra]),g=s.useCallback(async o=>{if(o.stopPropagation(),!a){i("Download expirado. Apenas Membros VIP têm acesso ilimitado.","erro");return}l(!0);try{const d=await(await fetch(`${u}?action=getDownloadLink&email=${encodeURIComponent(t.email)}&code=${r.code}&token=${n}`)).json();d.sucesso&&d.link?window.open(d.link,"_blank"):i(d.mensagem||"Erro ao obter link.","erro")}catch{i("Erro de conexão.","erro")}finally{l(!1)}},[a,t.email,r.code,n,i]);return e.jsxs("div",{className:`
                group relative flex flex-col h-full rounded-xl overflow-hidden border transition-all duration-300
                ${a?"bg-white dark:bg-[#080808] border-gray-100 dark:border-accent/30 hover:border-primary/50 dark:hover:border-accent hover:shadow-lg hover:-translate-y-1 cursor-pointer":"bg-gray-100 dark:bg-[#050505] border-gray-200 dark:border-white/5 opacity-80"}
            `,onClick:a?c:void 0,children:[e.jsx("div",{className:"absolute top-3 left-3 z-20",children:e.jsx("div",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider shadow-sm flex items-center gap-1 backdrop-blur-md ${a?"bg-green-500/90 text-white":"bg-red-500/90 text-white"}`,children:a?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-check-circle text-[9px]"})," Disponível"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-lock text-[9px]"})," Expirado"]})})}),e.jsxs("div",{className:`relative w-full aspect-[4/3] p-4 overflow-hidden ${a?"bg-gradient-to-b from-gray-50 to-white dark:from-[#050505] dark:to-[#050505]":"bg-gray-200 dark:bg-black/40 grayscale"}`,children:[e.jsx("img",{src:r.imagem||h,alt:r.nome,loading:"lazy",className:"w-full h-full object-contain mix-blend-multiply dark:mix-blend-normal transition-transform duration-500 group-hover:scale-105 opacity-90 group-hover:opacity-100"}),a&&e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center backdrop-blur-[2px]",children:e.jsx("div",{className:"bg-white/20 border border-white/30 rounded-full p-3 text-white",children:e.jsx("i",{className:"fas fa-search text-xl"})})})]}),e.jsxs("div",{className:`p-4 flex flex-col flex-grow border-t ${a?"border-gray-100 dark:border-white/5 bg-white dark:bg-[#080808]":"border-gray-200 dark:border-white/5 bg-gray-50 dark:bg-[#050505]"}`,children:[e.jsxs("div",{className:"text-[9px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-1",children:["Pedido #",r.numeroPedido]}),e.jsx("h3",{className:`text-sm font-medium leading-snug line-clamp-2 mb-2 min-h-[2.5em] transition-colors ${a?"text-gray-800 dark:text-gray-100 group-hover:text-primary dark:group-hover:text-accent":"text-gray-500 dark:text-gray-500"}`,children:r.nome}),e.jsxs("div",{className:"text-[10px] text-gray-500 dark:text-gray-400 mb-3 flex items-center gap-1.5",children:[e.jsx("i",{className:"far fa-calendar-alt opacity-70"}),e.jsx("span",{children:m})]}),e.jsxs("div",{className:"mt-auto pt-2",children:[e.jsx("button",{className:`w-full h-10 rounded-xl text-xs font-bold uppercase tracking-wider transition-all duration-200 flex items-center justify-center gap-2 shadow-md ${a?"bg-gradient-to-r from-green-500 to-emerald-600 text-white hover:brightness-110 hover:shadow-green-500/30":"bg-gray-300 dark:bg-white/10 text-gray-500 border border-transparent cursor-not-allowed"}`,disabled:!a,onClick:g,children:x?e.jsx("i",{className:"fas fa-spinner fa-spin"}):a?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-cloud-download-alt text-sm"})," Download"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-ban text-sm"})," Expired (24h)"]})}),!a&&!t.isVIP&&e.jsx("p",{className:"text-[9px] text-center text-red-500 mt-2 font-medium",children:"Acesso padrão expirado. Vire VIP para liberar."})]})]})]})});export{w as PurchasedCard};
